
% ------------------------------------------------------------
% ------------------------------------------------------------

\section[Geographical Plots]{Geographical Plots}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Plots using Maps}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile, allowframebreaks]
\frametitle{Geographic Maps (v0.1)}

To overlay a map to a plot containing latitude and longitude, load the package \ttfamily maps: \normalfont 

\begin{lstlisting}[ basicstyle=\footnotesize]
library(maps)
plot(
 x = df_clean$Longitude, 
 y = df_clean$Latitude,
 xlab = "Longitude",
 ylab = "Latitude",
 pch = 16,
 col = rgb(176/256, 196/256, 222/256, alpha=0.5)
)
map("state", "california", add=TRUE)
\end{lstlisting}

\newpage
	\begin{center}
		\includegraphics[scale=0.25]{images/geoplot_v0.png}
	\end{center}
What are some limitations of the plot?
\end{frame}

%___________
\begin{frame}[fragile, allowframebreaks]
\frametitle{Geographic Maps (v0.2)}

To include information on volume of procedure, use \ttfamily cex\normalfont argument of the \ttfamily plot() \normalfont function:

\begin{lstlisting}[ basicstyle=\footnotesize]
### Step 1: Aggregate data to be at hospital level:
df_hosp <- data_clean %>%
  group_by( Latitude, Longitude ) %>%
  summarise( Total.for.Hospital = sum(Volume, na.rm=TRUE) )
	
### Step 2: Recode 'Volume' to have 2 categories only: high ( >100 cases ) and low ( <= 100 cases ):
df_hosp$volume_ind <- ifelse( 
 test = df_hosp$Total.for.Hospital > 100, 
 yes = 2, 
 no = 1 )
\end{lstlisting}

\newpage
\begin{lstlisting}
### Step 3: Plot
plot(
 x = df_hosp$Longitude, 
 y = df_hosp$Latitude, 
 pch = 19, 
 cex = df_hosp$volume_ind, 
 col = df_hosp$volume_ind, 
 xlab = "Longitude", 
 ylab = "Latitude",
 main="Indicator of overall volume between 2005-2014"
)
map("state", "california", add=TRUE)
\end{lstlisting}

\begin{lstlisting}
### Step 4: Add legend
legend("topright", 
 pch = 19, 
 pt.cex = 1:2,
 col = 1:2, 
 c("Vol <= 100", "Vol > 100") 
)
\end{lstlisting}

\newpage
       \begin{center}
		\includegraphics[scale=0.25]{images/geoplot_v1.png}
	\end{center}
What are some limitations of the plot? (Exercise.)
\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Projection Maps}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[allowframebreaks, fragile]
\frametitle{Projection Maps}
  \framesubtitle{Map of Fiji Earthquakes Since 1964}

For a different perspective of a map, use  \ttfamily mapproject(): \normalfont 

\begin{lstlisting}
library(mapproj)
library(maps)
m <- map('world',plot=FALSE)
# Projection is Azimuthal with equal-area
map('world',proj='azequalarea',orient=c(longitude=0,latitude=180,rotation=0))
map.grid(m,col=2)
points(mapproject(list(                       y=quakes$lat[which(quakes$mag>=6)],       x=quakes$long[which(quakes$mag>=6)])),    col="blue",pch="x",cex=2)
\end{lstlisting}

\newpage
       \begin{center}
\includegraphics[width = 70mm]{images/Fuji2.pdf}
\end{center}

\end{frame}

% %%%%%%%%%%%
% \begin{frame}[fragile]
% 	\begin{alertblock}{Bonus Feature of the \ttfamily maps \normalfont package:}
% 		To determine in which part of the world the observations are (based on latitude and longitude), use \ttfamily map.where(): \normalfont
% 			\begin{lstlisting}		
% 				in.what.country<-map.where(database="world", quakes$long, quakes$lat)
% 			\end{lstlisting}
% 		To determine which observations are in the ocean: \normalfont
% 			\begin{lstlisting}
% 				# Number of points in ocean after filtering:
% 				ind<-sum(is.na(in.what.country)); ind
% 				# Number of observations: 1000
% 				# Number in Ocean: 993
% 			\end{lstlisting}
% 	\end{alertblock}

% \end{frame}

% ------------------------------------------------------------
% ------------------------------------------------------------
\subsection{Exercise III}
\begin{frame}
	\frametitle{Exercise III}
	For the \ttfamily ozone \normalfont data set \footnote{\ttfamily http://www.ats.ucla.edu/stat/R/faq/ozone.csv\normalfont}, determine the region of the world that the observations correspond to and overlay the appropriate map.
\end{frame}
%ozone<-read.table("http://www.ats.ucla.edu/stat/R/faq/ozone.csv", sep=",", header=T)
%attach(ozone)
%plot(Lat~Lon, xlim=c(-125, -113), ylim=c(31,42))
%map("state", "california", add=TRUE)